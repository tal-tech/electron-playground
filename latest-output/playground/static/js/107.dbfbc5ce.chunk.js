(this["webpackJsonpelectron-playground"]=this["webpackJsonpelectron-playground"]||[]).push([[107],{1360:function(n,e){n.exports=["# 1. \u521b\u5efa\u548c\u7ba1\u7406\u7a97\u53e3\n\n\u901a\u8fc7`electron`\u7684`BrowserWindow`\u6a21\u5757\uff0c\u6211\u4eec\u53ef\u4ee5\u8f7b\u677e __\u521b\u5efa__ \u548c __\u7ba1\u7406__ \u7a97\u53e3\u3002\n\n\n\u5728\u6d4f\u89c8\u5668\u6253\u5f00 [\u5b8c\u6574\u7684API\u6587\u6863](https://www.electronjs.org/docs/api/browser-window)\n\n\n\u6bcf\u4e2a\u5e94\u7528\uff0c\u56e0\u4e3a\u4e1a\u52a1\u7684\u4e0d\u540c\uff1b\u521b\u5efa\u548c\u7ba1\u7406\u7a97\u53e3\u7684\u65b9\u5f0f\u548c\u6d41\u7a0b\u4e5f\u5927\u4e0d\u76f8\u540c\uff1b\u8fd9\u91cc\u6211\u4eec\u4ee5\u4e0b\u6d41\u7a0b\u4e3a\u4f8b\uff1a\n\n<img src=\"./img/window-create.png\" alt=\"window create\">\n\n\n## 1.1. \u521b\u5efa\u7a97\u53e3\n\n\u901a\u8fc7`BrowserWindow`\uff0c\u6765 __\u521b\u5efa__ \u6216\u8005 __\u7ba1\u7406__ \u65b0\u7684\u6d4f\u89c8\u5668\u7a97\u53e3\uff0c\u6bcf\u4e2a\u6d4f\u89c8\u5668\u7a97\u53e3\u90fd\u6709\u4e00\u4e2a\u8fdb\u7a0b\u6765\u7ba1\u7406\u3002\n\n\u8fd9\u91cc\uff0c\u6211\u4eec\u628a __\u521b\u5efa__ \u548c __\u7ba1\u7406__\uff0c\u5206\u4e3a __\u7528\u6237\u884c\u4e3a__ \u548c __\u5e94\u7528\u672c\u8eab__\u3002\n\n\n__\u5e94\u7528\u672c\u8eab__ \u5373\u662f\uff1a\u5e94\u7528\u542f\u52a8 \u2014\u2014> \u7a97\u53e3\u521b\u5efa --\x3e \u7a97\u53e3\u5c55\u793a   \n__\u7528\u6237\u884c\u4e3a__ \u5373\u662f\uff1a\u7a97\u53e3\u5df2\u7ecf\u521b\u5efa\u5b8c\u6bd5\uff0c\u7528\u6237\u70b9\u51fb`a`\u94fe\u63a5\u800c\u521b\u5efa\u7684\u7a97\u53e3\u7684\u884c\u4e3a\n\n### 1.1.1. \u7b80\u5355\u521b\u5efa\u4e00\u4e2a\u7a97\u53e3\n```javascript\n// @@code-renderer: runner\n// @@code-props: { hideRight: false, height:'100px' }\nconst { BrowserWindow } = require('electron');\nconst win = new BrowserWindow();\nwin.loadURL('https://github.com');\n```\n\n### 1.1.2. \u4f18\u5316\n__\u95ee\u9898__\uff1a`electron`\u7684`BrowserWindow`\u6a21\u5757\u5728\u521b\u5efa\u65f6\uff0c\u5982\u679c\u6ca1\u6709\u914d\u7f6e`show:false`\uff0c\u5728\u521b\u5efa\u4e4b\u65f6\u5c31\u4f1a\u663e\u793a\u51fa\u6765\uff0c\u4e14\u9ed8\u8ba4\u7684\u80cc\u666f\u662f\u767d\u8272\uff1b\u7136\u540e\u7a97\u53e3\u8bf7\u6c42`HTML`\uff0c\u4f1a\u51fa\u73b0\u95ea\u70c1\u3002   \n\n[\u5b8c\u6574api\u6587\u6863](https://www.electronjs.org/docs/api/browser-window#%E4%BD%BF%E7%94%A8ready-to-show%E4%BA%8B%E4%BB%B6)\n\n__\u89e3\u51b3__\n```javascript\n// @@code-renderer: runner\n// @@code-props: { hideRight: true, height:'200px' }\nconst { BrowserWindow } = require('electron');\nconst win = new BrowserWindow({ show:false,x:100,y:100 });\n\nwin.loadURL('https://github.com');\n\nwin.on('ready-to-show',()=>{\n    win.show();\n})\n```\n__\u5bf9\u6bd4\u4e0a\u9762\u7b80\u5355\u521b\u5efa\u7a97\u53e3__\uff0c\u53ef\u4ee5\u660e\u663e\u770b\u51fa2\u8005\u7684\u533a\u522b\n\n`new BrowserWindow(options)`\uff0c[options\u914d\u7f6e\u6587\u6863](https://www.electronjs.org/docs/api/browser-window#new-browserwindowoptions)  \n\n\n## 1.2. \u7ba1\u7406\u7a97\u53e3\n\n### 1.2.1. \u7ba1\u7406\u5e94\u7528\u521b\u5efa\u7684\u7a97\u53e3\n\n`BrowserWindow`\u6a21\u5757\u5728\u521b\u5efa\u7a97\u53e3\u65f6\uff0c\u4f1a\u8fd4\u56de __\u7a97\u53e3\u5b9e\u4f8b__\n\n\u5728\u8fd9\u91cc\u4f7f\u7528`Map`\u5bf9\u8c61\u6765\u5b58\u50a8\u8fd9\u4e9b __\u7a97\u53e3\u5b9e\u4f8b__\n\n```typescript\nconst BrowserWindowsMap = new Map<number, BrowserWindow>()\nlet mainWindowId: number;\n\nconst browserWindows = new BrowserWindow({ show:false })\nbrowserWindows.loadURL('https://github.com')\nbrowserWindows.once('ready-to-show', () => {\n  browserWindows.show()\n})\nBrowserWindowsMap.set(browserWindow.id, browserWindow)\nmainWindowId = browserWindow.id  // \u8bb0\u5f55\u5f53\u524d\u7a97\u53e3\u4e3a\u4e3b\u7a97\u53e3\n```\n\n> \u4ee3\u7801\u4e2d\u63d0\u5230 __\u4e3b\u7a97\u53e3__\uff0c\u4ec0\u4e48\u662f\u4e3b\u7a97\u53e3\uff1f[\u4e3b\u7a97\u53e3\u9690\u85cf\u548c\u6062\u590d](./index.html#/browser/awaken)\u7ae0\u8282\n\n__\u7a97\u53e3\u88ab\u5173\u95ed__\uff0c\u5f97\u628a`Map`\u4e2d\u7684\u5b9e\u4f8b\u5220\u9664\u3002\n\n```typescript\nbrowserWindow.on('closed', () => {\n  BrowserWindowsMap?.delete(browserWindowID)\n})\n```\n### 1.2.2. \u7ba1\u7406\u7528\u6237\u521b\u5efa\u7684\u7a97\u53e3\n\u4e00\u4e2a\u7a97\u53e3\u4e2d\u5b58\u5728\u8bb8\u591a\u7684\u94fe\u63a5\uff0c\u4e0d\u7ba1\u662f\u94fe\u63a5\u8df3\u8f6c\uff0c\u6216\u662f\u521b\u5efa\u65b0\u7684\u7a97\u53e3\uff0c\u6211\u4eec\u90fd\u9700\u8981\u7ba1\u7406\u8fd9\u4e9b\u7a97\u53e3\u3002\n\n__\u4f7f\u7528`new-window`\u76d1\u542c\u7a97\u53e3\u521b\u5efa__\n\u4f7f\u7528`new-window`\u53ef\u76d1\u542c __\u65b0\u7a97\u53e3__ \u7684\u521b\u5efa\u3002\u6d4f\u89c8\u5668\u6253\u5f00[\u5b8c\u6574\u6587\u6863](https://www.electronjs.org/docs/api/web-contents#event-new-window)\n\n\u6838\u5fc3\u4ee3\u7801\u5982\u4e0b\uff1a\n```javascript\n// \u521b\u5efa\u7a97\u53e3\u76d1\u542c\nbrowserWindow.webContents.on('new-window', (event, url, frameName, disposition) => {\n  /** @params {string} disposition\n  *  new-window : window.open\u8c03\u7528\n  *  background-tab: command+click\n  *  foreground-tab: \u53f3\u952e\u70b9\u51fb\u65b0\u6807\u7b7e\u6253\u5f00\u6216\u70b9\u51fba\u6807\u7b7etarget _blank\u6253\u5f00\n  * /\n})\n```\n> \u6ce8\uff1a\u5173\u4e8e`disposition`\u5b57\u6bb5\u7684\u89e3\u91ca\uff0c\u79fb\u6b65[electron\u6587\u6863](https://www.electronjs.org/docs/api/web-contents#webcontents)\u3001[electron\u6e90\u7801](https://github.com/electron/electron/blob/72a089262e31054eabd342294ccdc4c414425c99/shell/browser/api/electron_api_web_contents.cc)\u3001[chrome \u6e90\u7801](https://chromium.googlesource.com/chromium/src/+/66.0.3359.158/ui/base/mojo/window_open_disposition_struct_traits.h)\n\n\n__\u6269\u5c55`new-window`__\n- \u53ef\u4ee5\u88ab \u5f53\u524d\u7a97\u53e3\u7684 `new-window`\u4e8b\u4ef6\u6355\u6349\u5230\u7684\n\n```javascript\nwindow.open('https://github.com')\n```\n\n```html\n<a href='https://github.com' target='__blank'>\u94fe\u63a5</a>\n```\n\n- \u4e0d\u53ef\u88ab \u5f53\u524d\u7a97\u53e3\u7684 `new-window`\u4e8b\u4ef6\u6355\u6349\u5230\u7684\n\u4ee5\u4e0bapi\u9700\u8981\u7a97\u53e3 \u96c6\u6210node\uff0c\u5373 __\u4e3b\u8fdb\u7a0b__ \u521b\u5efa\u65f6\u9700\u914d\u7f6e\n```javascript\nconst { BrowserWindow } = require('electron')\nconst parent = new BrowserWindow({ webPreferences:{nodeIntegration: true}});\n```\n__\u6e32\u67d3\u8fdb\u7a0b__ \u4f7f\u7528`BrowserWindow`\u521b\u5efa\u7a97\u53e3\n```javascript\nconst { BrowserWindow } = require('electron').remote\n\nconst win = new BrowserWindow()\nwin.loadURL('https://github.com')\n```\n__\u5e94\u7528`new-window`__\n__\u901a\u8fc7 __\u9ed8\u8ba4\u6d4f\u89c8\u5668__ \u6765\u6253\u5f00 __\u7b2c\u4e09\u65b9\u94fe\u63a5\n```typescript\nimport { shell } from 'electron'\nfunction openExternal(url: string) {\n  const HTTP_REGEXP = /^https?:\\/\\//\n  // \u975ehttp\u534f\u8bae\u4e0d\u6253\u5f00\uff0c\u9632\u6b62\u51fa\u73b0\u81ea\u5b9a\u4e49\u534f\u8bae\u7b49\u5bfc\u81f4\u7684\u5b89\u5168\u95ee\u9898\n  if (!HTTP_REGEXP) {\n    return false\n  }\n  try {\n    await shell.openExternal(url, options)\n    return true\n  } catch (error) {\n    console.error('open external error: ', error)\n    return false\n  }\n}\n// \u521b\u5efa\u7a97\u53e3\u76d1\u542c\nbrowserWindow.webContents.on('new-window', (event, url, frameName, disposition) => {\n  if (disposition === 'foreground-tab') {\n      // \u963b\u6b62\u9f20\u6807\u70b9\u51fb\u94fe\u63a5\n      event.preventDefault()\n      openExternal(url)\n  }\n})\n```\n\n##  1.3. \u5173\u95ed\u7a97\u53e3\n\u5173\u95ed\u7a97\u53e3\u6216\u8005\u9690\u85cf\u7684`API`\n\n###  1.3.1. `win.close()` \n1. \u5173\u95ed\u9875\u9762\uff0c\u5982\u679c\u963b\u6b62`close`\u4e8b\u4ef6\uff0c\u5c06\u4e0d\u4f1a\u5173\u95ed\u9875\u9762\uff0c\u8fd9\u4f1a __\u963b\u6b62\u8ba1\u7b97\u673a\u5173\u95ed__\uff1b\n2. \u5173\u95ed\u9875\u9762\u7684\u670d\u52a1\uff0c\u5982`websocket`\uff0c\u4e0b\u6b21\u6253\u5f00\u7a97\u53e3\uff0c\u7a97\u53e3\u4e2d\u7684\u9875\u9762\u4f1a __\u91cd\u65b0\u6e32\u67d3__\uff1b\n3. \u901a\u8fc7\u8fd9\u4e2a`API`\u89e6\u53d1\u7684`close`\u4e8b\u4ef6\u5728 `unload` \u548c `beforeunload`\u4e4b\u524d\u89e6\u53d1\uff0c\u901a\u8fc7\u8fd9\u70b9\u53ef\u4ee5\u5b9e\u73b0 __\u5173\u95ed\u65f6\u89e6\u53d1\u5f39\u7a97__\uff1b\n4. \u4f1a\u88ab`closed`\u4e8b\u4ef6\u6355\u6349\u5230\u3002\n\n__\u4f8b\u5b50__\uff1a\u5b9e\u73b0\u5173\u95ed\u7a97\u53e3\u4e4b\u524d\u89e6\u53d1\u5f39\u7a97\n\u4ee3\u7801\u5982\u4e0b\uff1a\n```javascript\n// @@code-renderer: runner\n// @@code-props: { hideRight: true, height:'100px' }\nconst { BrowserWindow } = require('electron');\nconst path = require('path');\nconst browserWindows = new BrowserWindow({webPreferences:{nodeIntegration: true,webSecurity: false}})\nbrowserWindows.loadURL('file:///' + path.resolve(__dirname, '../playground/index.html#/demo/window-close'))\n```\n\u6ce8\uff1a\n- \u4e0a\u9762\u4ee3\u7801\uff0c\u53ea\u80fd\u5e94\u7528\u4e8eelectron\u7aef\uff0c\u5728web\u7aef\u5237\u65b0\u4e0d\u8d77\u4f5c\u7528\uff1bweb\u7aef\u65e0\u6cd5\u5728\u9875\u9762\u5173\u95ed\u6216\u8005\u5237\u65b0\u4e4b\u524d\u963b\u585e\u6d4f\u89c8\u5668\uff1b\n<img src=\"./img/close-window-model.png\" alt=\"close-window-model\" />\n<img src=\"./img/close-window-model2.png\" alt=\"close-window-model\" />\n- \u963b\u6b62\u5173\u95ed\u7a97\u53e3\u51fa\u73b0\u7684\u5f39\u7a97\uff0c`img`\u5143\u7d20\u5916\u94fe`url`\u4e0d\u8d77\u4f5c\u7528\uff0c\u4f1a\u53d1\u51fa\u8bf7\u6c42\uff0c\u4f46\u662f\u4e0d\u4f1a\u6e32\u67d3\u51fa\u6765\uff0c\u53ef\u4ee5\u4f7f\u7528`div+background`\u7684\u65b9\u5f0f\uff1b\n- \u5173\u4e8e`beforeunload`[\u5b8c\u6574`API`\u6587\u6863](https://developer.mozilla.org/en-US/docs/Web/API/Window/beforeunload_event)\n\n### 1.3.2. `win.destroy()`\n1. \u5f3a\u5236\u9000\u51fa\uff0c\u65e0\u89c6`close`\u4e8b\u4ef6\uff1b\n2. \u5173\u95ed\u9875\u9762\uff0c\u4ee5\u53ca\u9875\u9762\u5185\u7684\u670d\u52a1\uff0c\u4e0b\u6b21\u6253\u5f00\u7a97\u53e3\uff0c\u7a97\u53e3\u4e2d\u7684\u9875\u9762\u4f1a\u91cd\u65b0\u6e32\u67d3\uff1b\n3. \u4f1a\u88ab`closed`\u4e8b\u4ef6\u6355\u6349\u5230\u3002\n\n### 1.3.3. `win.hide()`\n> \u8fd9\u4e2a\u9690\u85cf\u7a97\u53e3\u3002\n\n1. \u9690\u85cf\u7a97\u53e3\uff0c\u4f1a\u89e6\u53d1`hide`\u548c`blur`\u4e8b\u4ef6\uff0c\u540c\u6837\u4e5f\u662f\u53ef\u4ee5\u901a\u8fc7`event.preventDefault()`\u6765\u963b\u6b62\n2. \u53ea\u662f\u9690\u85cf\u7a97\u53e3\uff0c\u901a\u8fc7`win.show()`\uff0c\u53ef\u4ee5\u5c06\u7a97\u53e3\u663e\u73b0\uff0c\u5e76\u4e14\u4f1a\u4fdd\u6301\u539f\u6765\u7684\u7a97\u53e3\uff0c\u91cc\u9762\u7684\u670d\u52a1\u4e5f\u4e0d\u4f1a\u6302\u65ad\n\n\n## 1.4. \u5176\u4ed6\n- \u5173\u4e8e\u9875\u9762\u53ef\u89c1\u6027\uff0c\u53ef\u53c2\u89c1[\u6587\u6863](https://www.electronjs.org/docs/API/browser-window#%E9%A1%B5%E9%9D%A2%E5%8F%AF%E8%A7%81%E6%80%A7)\uff1b\n- __\u4e3b\u7a97\u53e3\u7684\u9690\u85cf\u548c\u5524\u9192__ \u7684\u5177\u4f53\u7ec6\u8282\uff0c\u53ef\u53c2\u89c1\u672c\u7ae0\u7684 [\u4e3b\u7a97\u53e3\u9690\u85cf\u548c\u6062\u590d](./index.html#/browser/awaken)\u7ae0\u8282\uff1b\n- \u7a97\u53e3\u5728\u88ab\u521b\u5efa\u4e4b\u540e\uff0c\u7a97\u53e3\u5b9e\u4f8b\u5404\u79cd __\u4e8b\u4ef6\u89e6\u53d1\u987a\u5e8f__ \u53ef\u53c2\u89c1 [\u7a97\u53e3\u89e6\u53d1\u987a\u5e8f](./index.html#/browser/window-event)\u7ae0\u8282\uff1b\n- __\u7a97\u53e3\u901a\u4fe1__\uff0c\u53ef\u53c2\u89c1 [\u7a97\u53e3\u901a\u4fe1](./index.html#/browser/communication)\u7ae0\u8282\uff1b\n- __\u65e0\u8fb9\u6846\u7a97\u53e3__\u3001__\u7236\u5b50\u7a97\u53e3__\u3001__\u6a21\u6001\u7a97\u53e3__\uff0c\u53c2\u89c1[\u7a97\u53e3\u7c7b\u578b](./index.html#/browser/window-type)\u7ae0\u8282\uff1b\n"].join("")}}]);